# 검색 기능 점검 보고서

작성일: 2025-12-24
대상: 통합 검색 모달 구현 (클라이언트 사이드 검색)
범위: `src/components/search/SearchModal.tsx`, `src/utils/reader.ts`

## 1. 개요
- 현재 구현은 브라우저에서 `getAllBooks/getAllAuthors/getAllNews/getAllDataRoom`을 호출해 인덱스를 구성하고, 단순 포함 검색으로 결과를 노출하는 구조입니다.
- PRD의 1단계(기본 구현) 요건은 충족하지만, 성능/정확도/복구성 측면에서 보완 필요 항목이 있습니다.

## 2. 주요 문제점
1. **재시도 불가 로딩 구조 (중요)**
   - 첫 로딩이 실패하면 `hasLoaded`가 `true`로 고정되어, 이후 재시도가 불가능합니다.
   - 모달을 닫아도 `error`가 유지되어, 사용자에게 실패 상태가 계속 노출될 수 있습니다.
   - 관련: `src/components/search/SearchModal.tsx`

2. **검색 인덱스 생성 비용 및 확장성 (중요)**
   - 브라우저에서 모든 콘텐츠 파일을 가져오고 문서를 파싱합니다.
   - 콘텐츠 양이 많아질 경우 초기 검색 진입 시 지연 및 메모리 사용량이 증가합니다.
   - PRD의 “경량 인덱스 JSON 분리” 요구와 상충합니다.
   - 관련: `src/components/search/SearchModal.tsx`, `src/utils/reader.ts`

3. **검색 정확도 누락 (중요)**
   - 뉴스 분류 검색어가 영어 라벨(Notice/Event 등)만 포함되어 있어 “공지/이벤트” 등 한글 키워드 검색이 실패할 수 있습니다.
   - PRD의 “태그/분류(type)” 검색 조건을 충분히 반영하지 못합니다.
   - 관련: `src/components/search/SearchModal.tsx`, `src/utils/content-adapters.ts`

4. **접근성(Accessibility) 미흡 (보완 필요)**
   - 모달 열림 상태에서 포커스 트랩이 없어, 탭 이동 시 배경 요소로 빠질 수 있습니다.
   - ESC 종료는 있으나, 키보드 중심 사용성에 보완 여지가 있습니다.
   - 관련: `src/components/search/SearchModal.tsx`

## 3. 보완/개선 제안
1. **로딩 실패 복구 플로우 추가**
   - 모달 닫힘 시 `error`와 `hasLoaded` 초기화 혹은 “다시 시도” 버튼 제공.
   - 로딩 재시도 로직을 별도 함수로 분리.

2. **빌드 타임 인덱스 생성**
   - 검색용 최소 메타데이터만 포함한 JSON 파일을 빌드 시 생성.
   - 런타임에는 JSON만 로드해 검색하도록 변경.
   - PRD의 “경량 인덱스” 요건을 충족하며 초기 지연 최소화.

3. **검색 키워드 확장**
   - 뉴스 분류는 `entry.type` 원본 값과 한글 라벨을 모두 인덱스에 포함.
   - 도서의 `series.volume`, `categories`, `isbn` 등 누락 필드도 확인하여 포함.

4. **검색 정확도 고도화 (선택)**
   - Fuse.js 도입 시 오타/유사어 검색 품질 향상.
   - 한글 초성 검색은 별도 유틸 추가로 가능.

5. **접근성 개선**
   - 모달에 focus trap 적용(예: `react-aria` 혹은 간단한 포커스 가드 구현).

## 4. 테스트 체크리스트
- 도서: 제목/ISBN/저자명/카테고리 키워드 검색
- 작가: 이름/약력 키워드 검색
- 소식: “공지/이벤트/신간” 등 분류 키워드 검색
- 자료실: 제목/설명 키워드 검색
- 로딩 실패 후 재시도 동작 확인
- 모바일/데스크톱에서 ESC 종료 및 포커스 이동 확인

## 5. 리스크/가정
- `publishedAt`이 없는 뉴스/자료실 항목은 검색 인덱스에서 제외될 수 있습니다.
- 콘텐츠 규모가 커질수록 첫 검색 진입 시 성능 저하가 커질 수 있습니다.
